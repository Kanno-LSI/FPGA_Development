# FPGA Development
FPGAによるシステム開発です。LSI Design Contestでのチーム開発の内容を説明しています。
<br><br><br><br>
## オートエンコーダを用いた災害ハザードマップ予測回路

## 目次
- [概要](#概要)
  - [目的](#〇-目的)
  - [システム内容](#〇-システム内容)
  - [チーム内の役割](#〇-チーム内の役割)
- [オートエンコーダとは](#オートエンコーダとは)
- [FPGA評価ボードの紹介](#FPGA評価ボードの紹介)
- [回路設計](#回路設計)
- [実機による動作検証](#実機による動作検証)
- [参考文献](#参考文献)

## 概要
FPGAのZynq ZCU104を用いた災害ハザードマップシステムです。

標高情報からオートエンコーダを介して危険地帯の予測を行い、地形データと合わせてハザードマップの3D表示を行います。

<div align="center">
    <img src="https://github.com/Kanno-LSI/LSI_Design_Contest/assets/131650927/a98ee72b-df89-44f0-9c5e-6640cc0617d4" width="500">
    <br> <!--改行-->
    <b>3Dハザードマップ</b> <!--テキスト表示-->
</div>

### 〇 目的

研究で使用し始めたFPGAの開発方法を学ぶとともに、チーム開発の一連の流れを掴むことを目的として開発を行いました。

### 〇 システム内容

PL部：オートエンコーダによる計算回路(今回のメイン)

PS部：ハザードマップの3D表示用アプリケーション

### 〇 チーム内の役割
今回は3人チームでの開発であり、筆者はチームのリーダーです。開発における役割は以下の通りです。

| メンバー | 役割 |
|-----------|-----------|
| メンバー1 | データセット作成 (Python) <br> オートエンコーダの学習部 (Python) |
| メンバー2  | オートエンコーダ推論部の回路 (VHDL) <br> 計算部分の回路シミュレーション (VHDL)|
| 筆者  | 通信回路、ステートマシン (VHDL) <br> 回路全体のコーディング <br> システムアプリケーション (Python) <br> 実機動作|

## オートエンコーダとは

## FPGA評価ボードについて
### FPGAとは
FPGA (Field-Programmable Gate Array)はハードウェア記述言語によって、ユーザーが自由に論理機能を書き換えられるハードウェアです。ASICなどと比べて、ハードウェアの開発期間を大幅に短縮することができます。

### 使用するFPGA評価ボードについて
AMD-Xilinx社製FPGAのZynqを使用しました。本評価ボードはFPGAに加えてSoCを搭載しています。そのため、計算負荷の大きい部分をFPGAによるPL(Programmable Logic)部に、アプリケーションの実装をSoCによるPS(Processing System)部に行うことで、評価ボード1台でシステムを完結させることができます。本評価ボードの詳細は以下の通りです。

|  |  |
|-----------|-----------|
| FPGA | Zynq Ultra Scale+ <br> MPSoC ZCU104 |
| Logic Cell | 504,000 |
| DSP Slice  | 1,728 |
| Bram  | 11[Mb] |
| 開発環境  | Vivado 2023.1 |

### PS部とPL部の役割


## 回路設計
### 全体図

## 実機による動作検証

## 参考文献





#### 〇　Function
・PWM制御

周波数を制御し、音色を変更します。


・外部入力割り込み

使用しているマイクロプロセッサ(ATtiny84A)の入力仕様は、外部から信号を入力されると、進行中の動作を一度中断して関数を実行するようになっています。その特殊な特性に合わせて曲の種類変更に利用しています。LEDにも信号を送ることで、次の曲の種類が分かるようにする機能（曲予約）に対応しました。


・AD変換、タイマ割り込み

AD変換を利用するとボリューム抵抗の回し具合に応じた数値を返すため、この機能を曲の速度変更に使用しています。また、タイマ割り込み内でAD変換を行うことで、リアルタイムで曲の速度を変更できます。


・ボリューム抵抗（ブレッドボード上）

圧電サウンダ（スピーカー）に加わる電圧を変化させ、音量を変更します。


### Requirement
マイクロプロセッサ(ATtiny84A)のファームウェア作成・書き込み環境

電子回路設計


### References
ATtiny84Aデータシート(参照：2023,05,21)

https://ww1.microchip.com/downloads/en/DeviceDoc/ATtiny24A-44A-84A-DataSheet-DS40002269A.pdf


### Demo

